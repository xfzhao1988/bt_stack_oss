<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.11.0"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>AmbiqSuite Example Guide: Secondary Bootloader</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<script type="text/javascript" src="clipboard.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="cookie.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="customdoxygen.css" rel="stylesheet" type="text/css" />
<link href="paramAlign.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectlogo"><img alt="Logo" src="am_logo.png"/></td>
  <td id="projectalign">
   <div id="projectname">AmbiqSuite Example Guide<span id="projectnumber">&#160;SDK 3.2.0</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.11.0 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() { codefold.init(0); });
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search',false);
  $(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="doc-content">
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function(){ initResizable(false); });
/* @license-end */
</script>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div class="header">
  <div class="summary">
<a href="#define-members">Macros</a> &#124;
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle"><div class="title">Secondary Bootloader<div class="ingroups"><a class="el" href="group__examples.html">Examples</a></div></div></div>
</div><!--header-->
<div class="contents">
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<p>Purpose: This program is an example template for a secondary bootloader program for Apollo3. It demonstrates how to access info0 key area. It demonstrates how to use the Ambiq SBL OTA framework for customer specific OTAs, e.g. to support external flash, or to support more advanced auth/enc schemes. It demonstrates how to validate &amp; transfer control to the real main program image (assumed to be at address specified by MAIN_PROGRAM_ADDR_IN_FLASH in flash) after locking the info0 area before exiting</p>
<p>This example only demonstrates nonsecure boot and nonsecure OTA.</p>
<p>Printing takes place over the ITM at 1M Baud.</p>
<p>Additional Information:</p>
<p>To exercise this program:</p><ul>
<li>Flash the main program at 0x10000 (MAIN_PROGRAM_ADDR_IN_FLASH)</li>
<li>Link this program at the address suitable for SBL nonsecure (0xC000) or secure (0xC100) configuration</li>
<li>To test OTA - construct images using magic numbers in the range matching AM_IMAGE_MAGIC_CUST</li>
<li>To test INFO0 key area access - need to keep INFO0-&gt;Security-&gt;PLONEXIT as 0 </li>
</ul>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="define-members" name="define-members"></a>
Macros</h2></td></tr>
<tr class="memitem:gacf041c3f2d0495c81091146d8f547666" id="r_gacf041c3f2d0495c81091146d8f547666"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#gacf041c3f2d0495c81091146d8f547666">INFO0_SECURITY_ADDR</a>&#160;&#160;&#160;(AM_HAL_FLASH_INFO_ADDR + 0x10)</td></tr>
<tr class="separator:gacf041c3f2d0495c81091146d8f547666"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gac84710529fd4479350f63dd74f30d3d2" id="r_gac84710529fd4479350f63dd74f30d3d2"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#gac84710529fd4479350f63dd74f30d3d2">INFO0_SECURITY_MASK_PLONEXIT</a>&#160;&#160;&#160;0x800</td></tr>
<tr class="separator:gac84710529fd4479350f63dd74f30d3d2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gaffe23303d91fb77f01fda6354a840fa3" id="r_gaffe23303d91fb77f01fda6354a840fa3"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#gaffe23303d91fb77f01fda6354a840fa3">MAIN_PROGRAM_ADDR_IN_FLASH</a>&#160;&#160;&#160;0x10000</td></tr>
<tr class="separator:gaffe23303d91fb77f01fda6354a840fa3"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="func-members" name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:gada6918e875c2674214a1330cf2488262" id="r_gada6918e875c2674214a1330cf2488262"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#gada6918e875c2674214a1330cf2488262">flash_page_erase</a> (uint32_t addr)</td></tr>
<tr class="memdesc:gada6918e875c2674214a1330cf2488262"><td class="mdescLeft">&#160;</td><td class="mdescRight">Wrapper for main flash page erase. Erases one page.  <br /></td></tr>
<tr class="separator:gada6918e875c2674214a1330cf2488262"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga840291bc02cba5474a4cb46a9b9566fe" id="r_ga840291bc02cba5474a4cb46a9b9566fe"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ga840291bc02cba5474a4cb46a9b9566fe">main</a> (void)</td></tr>
<tr class="separator:ga840291bc02cba5474a4cb46a9b9566fe"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<h2 class="groupheader">Macro Definition Documentation</h2>
<a id="gacf041c3f2d0495c81091146d8f547666" name="gacf041c3f2d0495c81091146d8f547666"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gacf041c3f2d0495c81091146d8f547666">&#9670;&#160;</a></span>INFO0_SECURITY_ADDR</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define INFO0_SECURITY_ADDR&#160;&#160;&#160;(AM_HAL_FLASH_INFO_ADDR + 0x10)</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="gac84710529fd4479350f63dd74f30d3d2" name="gac84710529fd4479350f63dd74f30d3d2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gac84710529fd4479350f63dd74f30d3d2">&#9670;&#160;</a></span>INFO0_SECURITY_MASK_PLONEXIT</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define INFO0_SECURITY_MASK_PLONEXIT&#160;&#160;&#160;0x800</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="gaffe23303d91fb77f01fda6354a840fa3" name="gaffe23303d91fb77f01fda6354a840fa3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gaffe23303d91fb77f01fda6354a840fa3">&#9670;&#160;</a></span>MAIN_PROGRAM_ADDR_IN_FLASH</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define MAIN_PROGRAM_ADDR_IN_FLASH&#160;&#160;&#160;0x10000</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<h2 class="groupheader">Function Documentation</h2>
<a id="gada6918e875c2674214a1330cf2488262" name="gada6918e875c2674214a1330cf2488262"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gada6918e875c2674214a1330cf2488262">&#9670;&#160;</a></span>flash_page_erase()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int flash_page_erase </td>
          <td>(</td>
          <td class="paramtype">uint32_t</td>          <td class="paramname"><span class="paramname"><em>addr</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Wrapper for main flash page erase. Erases one page. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">addr</td><td>Any address within the desired flash page</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Returns 0 on success </dd></dl>

</div>
</div>
<a id="ga840291bc02cba5474a4cb46a9b9566fe" name="ga840291bc02cba5474a4cb46a9b9566fe"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga840291bc02cba5474a4cb46a9b9566fe">&#9670;&#160;</a></span>main()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int main </td>
          <td>(</td>
          <td class="paramtype">void</td>          <td class="paramname"><span class="paramname"><em></em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
</div><!-- contents -->
<hr size="1">
    <body>
        <div id="footer" align="right">        
            <small>
                Generated on Wed Sep 4 2024 23:05:15 for the AmbiqSuite Example Guide by&nbsp;
                <a href="http://www.ambiqmicro.com">
                <img class="footer" src="./ambiq_logo.png" alt="Ambiq"/></a>&nbsp&nbsp Copyright &copy; 2024&nbsp&nbsp<br />
                This documentation is licensed and distributed under the <a rel="license" href="http://opensource.org/licenses/BSD-3-Clause">BSD 3-Clause License</a>.&nbsp&nbsp<br/>
            </small>
        </div>
    </body>
</html>
